@page "/creature/{CreatureId}"
@using SelfQuest.Models
@using SelfQuest.Services
@inject ICreatureService CreatureService

@code {
    [Parameter] public string CreatureId { get; set; }
    private CreatureDto creature;
    private bool isLoading = true;

    // Demo data for quests (replace with real API calls if you have them)
    private List<QuestDto> dailyQuests = new()
    {
        new QuestDto { Title = "Walk for 30 min.", Exp = 35, IsDaily = true }
    };
    private List<QuestDto> weeklyQuests = new();

    protected override async Task OnInitializedAsync()
    {
        creature = await CreatureService.GetCreatureByIdAsync(CreatureId);
        // TODO: Load quests for this creature if your API supports it
        isLoading = false;
    }
}

@if (isLoading)
{
    <div class="flex justify-center items-center h-64">
        <span>Loading your creature...</span>
    </div>
}
else if (creature != null)
{
    <div class="min-h-screen bg-green-100 flex flex-col items-center py-8">
        <!-- Creature Name and Title -->
        <div class="text-center mb-4">
            <div class="text-2xl font-bold text-gray-800 mb-1">@creature.Name</div>
            <div class="text-lg text-gray-600 font-semibold mb-2">the Active Tiger</div>
        </div>

        <!-- Creature Image -->
        <div class="mb-4">
            @if (!string.IsNullOrEmpty(creature.ImageUrl))
            {
                <img src="@creature.ImageUrl" alt="@creature.Name" class="w-32 h-32 object-contain rounded-full shadow" />
            }
            else
            {
                <span class="text-8xl">üêØ</span>
            }
        </div>

        <!-- Level and EXP Bar -->
        <div class="w-full max-w-md px-4 mb-6">
            <div class="flex justify-between items-center mb-1">
                <span class="font-semibold text-gray-700">LEVEL @creature.Level</span>
                <span class="text-sm text-gray-500">@creature.Xp EXP</span>
            </div>
            <div class="w-full h-4 bg-gray-300 rounded-full overflow-hidden">
                <div class="h-4 bg-green-400" style="width:@(40)%"></div>
            </div>
        </div>

        <!-- Quests Section -->
        <div class="w-full max-w-md px-4">
            <div class="font-bold text-lg text-gray-800 mb-2">Active Tiger Quests</div>
            <div class="mb-4">
                <div class="font-semibold text-gray-700 mb-1">Daily</div>
                @if (dailyQuests.Any())
                {
                    @foreach (var quest in dailyQuests)
                    {
                        <div class="flex items-center justify-between bg-white rounded-xl p-3 mb-2 shadow">
                            <div>
                                <div class="font-medium text-gray-800">@quest.Title</div>
                                <div class="text-xs text-green-600 font-semibold">@quest.Exp EXP</div>
                            </div>
                            <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-1 rounded-full transition">
                                Start
                            </button>
                        </div>
                    }
                }
                else
                {
                    <div class="text-gray-400">No daily quests.</div>
                }
            </div>
            <div>
                <div class="font-semibold text-gray-700 mb-1">Weekly</div>
                @if (weeklyQuests.Any())
                {
                    @foreach (var quest in weeklyQuests)
                    {
                        <div class="flex items-center justify-between bg-white rounded-xl p-3 mb-2 shadow">
                            <div>
                                <div class="font-medium text-gray-800">@quest.Title</div>
                                <div class="text-xs text-green-600 font-semibold">@quest.Exp EXP</div>
                            </div>
                            <button class="bg-green-500 hover:bg-green-600 text-white px-4 py-1 rounded-full transition">
                                Start
                            </button>
                        </div>
                    }
                }
                else
                {
                    <div class="text-gray-400">No weekly quests.</div>
                }
            </div>
        </div>
    </div>
}
else
{
    <div class="flex justify-center items-center h-64">
        <span>Couldn‚Äôt find that creature. Maybe it‚Äôs hiding?</span>
    </div>
}

@code {
    // Simple quest DTO for demo
    public class QuestDto
    {
        public string Title { get; set; }
        public int Exp { get; set; }
        public bool IsDaily { get; set; }
    }
}
